[
  {
    "objectID": "Homework_6.html",
    "href": "Homework_6.html",
    "title": "Homework_6",
    "section": "",
    "text": "Question 1\n\n##################################################\n# FUNCTION: log_growth \n# Purpose: Creating a logistic growth model that returns a dataframe with columns for population size and time.\n# Inputs: N0 = initial population size\n# r = intrinsic growth rate \n# K = carrying capacity\n# tfinal = ending time for simulation\n# tstep  = time step increment\n# Output: A dataframe with any time between 1:20 with intervals of 1\n# Nt = population size at each time\n\n##################################################\n\nlog_growth &lt;- function(N0=100, r=0.3, K=150, tfinal=20, tstep=1) {\n# time vector \ntime &lt;- seq(from=0, to=tfinal, by=tstep)\n  \n# logistic growth equation\nNt &lt;- K / (1 + ((K - N0) / N0) * exp(-r * time))\n  \n# dataframe for plotting\ndf_log_growth &lt;- data.frame(time=time, Nt=Nt)\n  \nreturn(df_log_growth)\n\n}\nlog_growth()\n\n   time       Nt\n1     0 100.0000\n2     1 109.4564\n3     2 117.7019\n4     3 124.6588\n5     4 130.3671\n6     5 134.9449\n7     6 138.5490\n8     7 141.3457\n9     8 143.4914\n10    9 145.1235\n11   10 146.3567\n12   11 147.2839\n13   12 147.9783\n14   13 148.4971\n15   14 148.8837\n16   15 149.1714\n17   16 149.3853\n18   17 149.5441\n19   18 149.6620\n20   19 149.7495\n21   20 149.8143\n\n# Question 2\n\n##################################################\n# Purpose: Take the data frame log_growth and create a plot of time as the x-axis and population as the y-axis\n# Input: data frame with two columns of time and population\n# Output: Plot\n\nplot_log_growth &lt;- function(df_log_growth) {\n\nplot(x = df_log_growth$time, \ny = df_log_growth$Nt,\nmain = \"Logistical Growth Model\",\nxlab = \"Time in Years\",\nylab = \"Population Size\",\ntype = \"l\")\n}\n\ndf &lt;- log_growth()\nplot_log_growth(df)"
  },
  {
    "objectID": "Homework_02.html",
    "href": "Homework_02.html",
    "title": "Homework_02.qmd",
    "section": "",
    "text": "This page will be used to post my homeworks for comp bio"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "OlteanuBIOL6100HW",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites.\nHomework 1\nHomework 3\nHomework 4\nHomework 5"
  },
  {
    "objectID": "Homework_7.html",
    "href": "Homework_7.html",
    "title": "Homework 6",
    "section": "",
    "text": "library(deSolve)\nlibrary(ggplot2)\n\n############################################################\n# FUNCTION: run_sir_model\n# PURPOSE: Solve deterministic SIR model with deSolve\n# INPUTS:\n#   beta, gamma : transmission & recovery rates\n#   N           : total population\n#   S0, I0, R0  : initial conditions\n#   t_start     : start time\n#   t_end       : end time\n#   dt          : timestep\n# OUTPUT:\n#   data.frame with columns: time, S, I, R\n############################################################\n\nrun_sir_model &lt;- function(\n  beta    = 0.1,\n  gamma   = 0.1,\n  N       = 1000,\n  S0      = 999,\n  I0      = 1,\n  R0      = 0,\n  t_start = 0,\n  t_end   = 160,\n  dt      = 1\n) {\n\n  init  &lt;- c(S = S0, I = I0, R = R0)\n  times &lt;- seq(t_start, t_end, by = dt)\n\n  sir_equations &lt;- function(time, state, parameters) {\n    with(as.list(c(state, parameters)), {\n      dS &lt;- -beta * S * I / N\n      dI &lt;-  beta * S * I / N - gamma * I\n      dR &lt;-  gamma * I\n      list(c(dS, dI, dR))\n    })\n  }\n\n  out &lt;- ode(\n    y     = init,\n    times = times,\n    func  = sir_equations,\n    parms = c(beta = beta, gamma = gamma, N = N)\n  )\n\n  as.data.frame(out)\n}\n\n# PURPOSE: Create a data frame with max infected, beta, and gamma with vectors of β and γ values ranging from 0 to 0.5 in steps of 0.01.\n# INPUTS:\n#   beta, gamma : transmission & recovery rates\n#   N           : total population\n#   S0, I0, R0  : initial conditions\n#   t_start     : start time\n#   t_end       : end time\n#   dt          : timestep\n# OUTPUT: df with columns, max_infected, beta, gamma\n\nsir_para_sweep &lt;- function(beta_vec, gamma_vec) {\n  n_combos &lt;- length(beta_vec) * length(gamma_vec)\n  sir_result &lt;- data.frame(\n    max_infected = numeric(n_combos),\n    beta = numeric(n_combos),\n    gamma = numeric(n_combos)\n  )\n  \n  counter &lt;- 1\n  for (b in beta_vec) {\n    for (g in gamma_vec) {\n      \n      # uses previous and changes only beta and gamma \n      sir_out &lt;- run_sir_model(beta = b, gamma = g)\n      \n      sir_result$max_infected[counter] &lt;- max(sir_out$I)\n      sir_result$beta[counter] &lt;- b\n      sir_result$gamma[counter] &lt;- g\n      counter &lt;- counter + 1\n    }\n  }\n    return(sir_result)\n}\n\n\n# FUNCTION: plot_sir_heatmap_ggplot\n# PURPOSE: Create a heatmap of max(number of infected) with Transmission Rate, β and Recovery Rate,γ as your x and y axises\n# INPUT: sweep_df : data frame with columns beta, gamma, max_infected\n# OUTPUT: Heatmap\n\nplot_sir_heatmap_ggplot &lt;- function(sweep_df) {\n\n  p &lt;- ggplot(sweep_df, aes(x = beta, y = gamma, fill = max_infected)) +\n    geom_tile() +\n    scale_fill_gradient(\n      low = \"blue\", \n      high = \"red\", \n      name = \"Max Infected\"\n    ) +\n    labs(\n      x = expression(\"Transmission Rate (\" * beta * \")\"),\n      y = expression(\"Recovery Rate (\" * gamma * \")\"),\n      title = \"SIR Model Parameter Sweep\"\n    ) +\n    theme_minimal() +\n    theme(plot.title = element_text(size = 20))\n  \n  return(p)\n}\n\nbeta_vec  &lt;- seq(0, 0.5, by = 0.01)\ngamma_vec &lt;- seq(0, 0.5, by = 0.01)\nsweep_results &lt;- sir_para_sweep(beta_vec, gamma_vec)\nplot_sir_heatmap_ggplot(sweep_results)"
  }
]